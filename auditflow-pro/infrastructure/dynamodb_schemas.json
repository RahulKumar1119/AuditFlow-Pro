{
  "tables": {
    "AuditFlow-Documents": {
      "description": "Stores document metadata, classification results, and extracted data",
      "primary_key": {
        "partition_key": {
          "name": "document_id",
          "type": "S",
          "description": "Unique identifier for each document (UUID)"
        }
      },
      "attributes": [
        {
          "name": "document_id",
          "type": "S",
          "description": "Primary key - unique document identifier"
        },
        {
          "name": "loan_application_id",
          "type": "S",
          "description": "Groups documents by loan application"
        },
        {
          "name": "upload_timestamp",
          "type": "S",
          "description": "ISO 8601 timestamp of document upload"
        },
        {
          "name": "processing_status",
          "type": "S",
          "description": "Current processing status: PENDING, PROCESSING, COMPLETED, FAILED"
        },
        {
          "name": "s3_bucket",
          "type": "S",
          "description": "S3 bucket containing the document"
        },
        {
          "name": "s3_key",
          "type": "S",
          "description": "S3 object key for the document"
        },
        {
          "name": "uploaded_by",
          "type": "S",
          "description": "User email who uploaded the document"
        },
        {
          "name": "file_name",
          "type": "S",
          "description": "Original filename"
        },
        {
          "name": "file_size_bytes",
          "type": "N",
          "description": "File size in bytes"
        },
        {
          "name": "file_format",
          "type": "S",
          "description": "File format: PDF, JPEG, PNG, TIFF"
        },
        {
          "name": "checksum",
          "type": "S",
          "description": "SHA-256 checksum for integrity verification"
        },
        {
          "name": "document_type",
          "type": "S",
          "description": "Classified document type: W2, BANK_STATEMENT, TAX_FORM, DRIVERS_LICENSE, ID_DOCUMENT"
        },
        {
          "name": "classification_confidence",
          "type": "N",
          "description": "Confidence score for document classification (0-1)"
        },
        {
          "name": "extracted_data",
          "type": "M",
          "description": "Map of extracted fields with confidence scores"
        },
        {
          "name": "extraction_timestamp",
          "type": "S",
          "description": "ISO 8601 timestamp when data extraction completed"
        },
        {
          "name": "page_count",
          "type": "N",
          "description": "Number of pages in the document"
        },
        {
          "name": "low_confidence_fields",
          "type": "L",
          "description": "List of field names with confidence < 80%"
        },
        {
          "name": "requires_manual_review",
          "type": "BOOL",
          "description": "Flag indicating manual review is needed"
        },
        {
          "name": "pii_detected",
          "type": "L",
          "description": "List of PII types detected in the document"
        },
        {
          "name": "encryption_key_id",
          "type": "S",
          "description": "KMS key ID used for encryption"
        },
        {
          "name": "ttl",
          "type": "N",
          "description": "Unix timestamp for automatic deletion (archival after 90 days, deletion after 7 years)"
        }
      ],
      "global_secondary_indexes": [
        {
          "index_name": "loan_application_id-upload_timestamp-index",
          "partition_key": "loan_application_id",
          "sort_key": "upload_timestamp",
          "projection": "ALL",
          "description": "Query all documents for a specific loan application, sorted by upload time"
        },
        {
          "index_name": "processing_status-upload_timestamp-index",
          "partition_key": "processing_status",
          "sort_key": "upload_timestamp",
          "projection": "ALL",
          "description": "Query documents by processing status (for audit queue display)"
        }
      ],
      "encryption": {
        "enabled": true,
        "type": "KMS",
        "description": "Server-side encryption using AWS KMS"
      },
      "ttl": {
        "enabled": true,
        "attribute": "ttl",
        "description": "Automatic deletion based on retention policy"
      },
      "billing_mode": "PAY_PER_REQUEST",
      "point_in_time_recovery": true
    },
    "AuditFlow-AuditRecords": {
      "description": "Stores complete audit results including risk scores, inconsistencies, and golden records",
      "primary_key": {
        "partition_key": {
          "name": "audit_record_id",
          "type": "S",
          "description": "Unique identifier for each audit record (UUID)"
        }
      },
      "attributes": [
        {
          "name": "audit_record_id",
          "type": "S",
          "description": "Primary key - unique audit record identifier"
        },
        {
          "name": "loan_application_id",
          "type": "S",
          "description": "Links audit to loan application"
        },
        {
          "name": "audit_timestamp",
          "type": "S",
          "description": "ISO 8601 timestamp when audit completed"
        },
        {
          "name": "risk_score",
          "type": "N",
          "description": "Calculated risk score (0-100)"
        },
        {
          "name": "status",
          "type": "S",
          "description": "Audit status: COMPLETED, IN_PROGRESS, FAILED"
        },
        {
          "name": "applicant_name",
          "type": "S",
          "description": "Name of loan applicant from golden record"
        },
        {
          "name": "processing_duration_seconds",
          "type": "N",
          "description": "Total time taken to complete audit"
        },
        {
          "name": "documents",
          "type": "L",
          "description": "List of document references included in this audit"
        },
        {
          "name": "golden_record",
          "type": "M",
          "description": "Consolidated authoritative applicant data"
        },
        {
          "name": "inconsistencies",
          "type": "L",
          "description": "List of detected inconsistencies with severity levels"
        },
        {
          "name": "risk_level",
          "type": "S",
          "description": "Risk level: LOW, MEDIUM, HIGH, CRITICAL"
        },
        {
          "name": "risk_factors",
          "type": "L",
          "description": "List of factors contributing to risk score"
        },
        {
          "name": "alerts_triggered",
          "type": "L",
          "description": "List of alerts generated during audit"
        },
        {
          "name": "reviewed_by",
          "type": "S",
          "description": "User email who reviewed the audit (optional)"
        },
        {
          "name": "review_timestamp",
          "type": "S",
          "description": "ISO 8601 timestamp of review (optional)"
        },
        {
          "name": "review_notes",
          "type": "S",
          "description": "Notes added during manual review (optional)"
        },
        {
          "name": "archived",
          "type": "BOOL",
          "description": "Flag indicating if record has been archived to Glacier"
        },
        {
          "name": "archive_timestamp",
          "type": "S",
          "description": "ISO 8601 timestamp when archived (optional)"
        },
        {
          "name": "ttl",
          "type": "N",
          "description": "Unix timestamp for automatic deletion (7 years retention)"
        }
      ],
      "global_secondary_indexes": [
        {
          "index_name": "loan_application_id-audit_timestamp-index",
          "partition_key": "loan_application_id",
          "sort_key": "audit_timestamp",
          "projection": "ALL",
          "description": "Query all audits for a specific loan application, sorted by time"
        },
        {
          "index_name": "risk_score-audit_timestamp-index",
          "partition_key": "status",
          "sort_key": "risk_score",
          "projection": "ALL",
          "description": "Query audits by status and filter/sort by risk score (for high-risk queue)"
        },
        {
          "index_name": "status-audit_timestamp-index",
          "partition_key": "status",
          "sort_key": "audit_timestamp",
          "projection": "ALL",
          "description": "Query audits by status, sorted by timestamp"
        }
      ],
      "encryption": {
        "enabled": true,
        "type": "KMS",
        "description": "Server-side encryption using AWS KMS with field-level encryption for PII"
      },
      "ttl": {
        "enabled": true,
        "attribute": "ttl",
        "description": "Automatic deletion after 7 years for compliance"
      },
      "billing_mode": "PAY_PER_REQUEST",
      "point_in_time_recovery": true
    }
  },
  "design_notes": {
    "partition_key_design": "Both tables use UUID-based partition keys to ensure even distribution across partitions and avoid hot partitions",
    "gsi_design": "GSIs enable efficient querying by loan_application_id, processing_status, risk_score, and audit_timestamp without scanning the entire table",
    "billing_mode": "PAY_PER_REQUEST (on-demand) chosen for unpredictable workload patterns and automatic scaling",
    "encryption": "KMS encryption at rest for all data, with additional field-level encryption for PII fields in application code",
    "ttl": "Automatic deletion using DynamoDB TTL feature for compliance with 7-year retention policy",
    "capacity_planning": "On-demand billing supports up to 1000 requests/second as specified in requirements, with automatic scaling beyond that"
  }
}
